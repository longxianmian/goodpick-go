我现在在部署 GoodPick Go 到阿里云 ECS，遇到一个后端 500 的问题，麻烦你在当前 Replit workspace 里帮我彻底排查并修复。

一、问题现象（ECS 上）

接口 GET /api/campaigns/1 返回 500：

{"success":false,"message":"Failed to get campaign"}


服务器日志 logs/err.log 中的错误如下（节选）：

Get campaign error: ErrorEvent {
  [Symbol(kTarget)]: WebSocket {
    _url: 'wss://localhost/v2',
    ...
    [Symbol(kError)]: AggregateError [ECONNREFUSED]: ...
}


说明：在处理 /api/campaigns/:id 时，代码里还有一段逻辑在尝试连接 wss://localhost/v2，这是 Replit AI Integrations 的本地 WebSocket 网关，阿里云上不存在，所以会 ECONNREFUSED，导致整个接口 500。

二、已经做过的改动

server/services/translationService.ts 已经改成用 标准 OpenAI HTTP API 调用，不再依赖 Replit 的 AI Integrations。

server/routes.ts 中 /api/campaigns/:id 这一行已经从 optionalUserAuth 改为公开路由：

app.get('/api/campaigns/:id', async (req: Request, res: Response) => { ... })


仓库里显式的 wss://localhost/v2 字符串、AI_INTEGRATIONS_* 环境变量引用等，基本都已经清理。

但在 ECS 上的 logs/err.log 里，Get campaign error 依然打印出了 ErrorEvent 和 WebSocket { _url: 'wss://localhost/v2' }，说明：
👉 还有某个 服务端模块 在使用 Replit 的 WebSocket/Realtime 客户端，这个逻辑在阿里云上必须彻底禁用或改为纯 HTTP。

三、你需要在 Replit 里完成的事情

请你在当前 Replit workspace 中，按下面步骤操作（你可以自己执行命令 / 修改代码）：

全局搜索所有可能使用 Replit AI / WebSocket 的代码（包括 server 和 node_modules）

搜索关键字：

WebSocket

AI_INTEGRATIONS_OPENAI_BASE_URL

AI_INTEGRATIONS_OPENAI_API_KEY

wss://

localhost/v2

realtime

重点关注：

server/ 目录下所有 service / middleware / util

是否有单独的 AI / Realtime / Logging 相关 service

找出谁在处理 /api/campaigns/:id 时触发了 WebSocket 连接

查看 server/routes.ts 里 /api/campaigns/:id 的实现，确认它是否调用了任何：

AI 相关 service

Realtime / Streaming 相关函数

如果有，请将其改成：

在阿里云 / 非 Replit 环境中 完全禁用 WebSocket / Replit AI Integrations；

只使用：

数据库 db 查询

getCampaignTranslatedContent 这种纯函数

或使用标准 OpenAI HTTP API（https://api.openai.com/v1），绝对不能再走 wss://localhost/v2。

彻底删除或禁用所有 Replit 专用 AI 集成代码（服务器端）

不允许在服务器上再出现任何“自动检测 Replit 环境然后连 wss://localhost/v2”的逻辑。

如果某段逻辑只在“开发环境 / Replit 调试”才需要，可以：

加环境变量开关，比如 USE_REPLIT_AI=false；

或用 process.env.REPL_ID / process.env.REPLIT_ENVIRONMENT 判断，在非 Replit 环境下直接跳过。

确保翻译功能只用标准 OpenAI HTTP API（可选项）

所有翻译相关逻辑，统一走 OPENAI_API_KEY + https://api.openai.com/v1/chat/completions。

失败时要有兜底：返回原文，而不是抛出异常导致接口 500。

在 Replit 本地验证 /api/campaigns/1

运行：

npm run build
npm start   # 或项目中用于启动生产 server 的命令


在 Replit Shell 里用 curl 测试：

curl -i http://127.0.0.1:5000/api/campaigns/1


预期结果：

返回 HTTP 200，JSON 类似：

{ "success": true, "data": { ... } }


Replit 控制台中 不再出现任何 wss://localhost/v2 / ErrorEvent / WebSocket 的错误日志。

确认所有改动已经提交并推送到 GitHub

在 Replit 中执行：

git status
git add .
git commit -m "chore: remove all Replit AI Realtime ws usage from server"
git push


请你一步步执行以上操作，遇到不确定的地方，请在修改前后把关键代码片段贴给我（或者直接自己修改好），最终目标是：

✅ 在非 Replit 环境（阿里云 ECS）下，GET /api/campaigns/1 不再尝试连接 wss://localhost/v2，并稳定返回 200 或 404，而不是 500。

指令结束👆。